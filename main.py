from pprint import pprint
from morpher import morph, register_function, create_morph
import json

register_function("process_tags", lambda x: [x, len(x)])

pprint(
    morph(
        source_json_path="example.json",
        recipe_path="example.morph"
    )
)

with open("example.json") as f:
    s = json.loads(f.read())

f = create_morph(recipe_path="example.morph")
pprint(
    f(s)
)

x = {'type': 'contact', 'id': '62caca6a619480f7c6a5d098', 'workspace_id': 'v7g38gws', 'external_id': '712105', 'role': 'user', 'email': 'annamatsk@yahoo.com', 'phone': '+972507751161', 'name': '×× ×” x1161 (IL)', 'avatar': None, 'owner_id': None, 'social_profiles': {'type': 'list', 'data': []}, 'has_hard_bounced': False, 'marked_email_as_spam': False, 'unsubscribed_from_emails': False, 'created_at': 1657457258, 'updated_at': 1671124142, 'signed_up_at': 1657539062, 'last_seen_at': 1671123544, 'last_replied_at': 1670581648, 'last_contacted_at': 1671119169, 'last_email_opened_at': 1670751518, 'last_email_clicked_at': 1670511683, 'language_override': 'en', 'browser': 'chrome', 'browser_version': '108.0.0.0', 'browser_language': 'en', 'os': 'Windows 10', 'location': {'type': 'location', 'country': 'Israel', 'region': 'Central District', 'city': 'Netanya', 'country_code': 'ISR', 'continent_code': 'AS'}, 'android_app_name': 'Novakid', 'android_app_version': '2.16.0', 'android_device': 'Redmi Note 7', 'android_os_version': '10', 'android_sdk_version': None, 'android_last_seen_at': 1669896190, 'ios_app_name': None, 'ios_app_version': None, 'ios_device': None, 'ios_os_version': None, 'ios_sdk_version': None, 'ios_last_seen_at': None, 'custom_attributes': {'3rdClassDate': 1658498400, 'ActiveFreezing': False, 'AutoLoginToken': 'eyJsb2dpbiI6ICJhbm5hbWF0c2tAeWFob28uY29tIiwgInBhc3N3b3JkIjogIjgwOTEwMjYyNDg0MTMwNzYifQ==', 'AutoLoginUrl': 'https://school.novakidschool.com/signin?autologin=eyJsb2dpbiI6ICJhbm5hbWF0c2tAeWFob28uY29tIiwgInBhc3N3b3JkIjogIjgwOTEwMjYyNDg0MTMwNzYifQ%3D%3D', 'BonusExpireDate': '2023-06-12T20:46:26.651029+00:00', 'ChurnComment': None, 'ChurnRisk': None, 'ChurnStatus': 'active', 'ClassesTaken': 43, 'CurrentBalance': 6, 'CurrentBalanceNN': 10, 'CurrentBonusBalance': 223.0, 'CurrentBonusBalanceString': '223 â‚ª', 'CurrentStatus': 'Subscription 24', 'DeclineAutoContinueDate': None, 'EstimatedAutoPaymentDate': None, 'EstimatedAutoPaymentDateStr': None, 'FirstPaymentFailedDate': None, 'FirstPaymentType': 'S4-2NN', 'FirstPurchaseDate': 1657636864, 'FirstStudentName': 'Noam', 'FirstStudentYearBirth': 2011, 'FourthPurchaseDate': None, 'HasTrialSubscription': False, 'IsAcceptingNewStudents': None, 'IsArchived': False, 'IsCandidate': None, 'Lang': 'en', 'LastAutoPaymentFailed': False, 'LastBalanceTopUp': 1659958770, 'LastClassCompletedLevel': 2, 'LastClassCompletedNextLevel': 2, 'LastClassCompletedStudent': 'Noam', 'LastClassCompletedTeacherName': 'Emily Vera', 'LastClassCompletedTeacherShortName': 'Emily V', 'LastClassCompletedUnit': 8, 'LastClassDate': 1671121800, 'LastClassDateStr': '15.12.2022', 'LastClassLessonContentID': 1944, 'LastClassReasonOfFail': None, 'LastClassRedo': None, 'LastClassRedoStudent': None, 'LastClassResult': 'Completed', 'LastClassSourceOfCancel': None, 'LastClassSourceOfFail': None, 'LastClassTrial': False, 'LastPayment': 1659958769, 'LastPaymentDiscountPercentage': None, 'LastPaymentNumber': 2, 'LastPaymentSum': 386, 'LastPaymentSystem': 'stripe', 'LastPaymentType': 'S24-2NN', 'LastSubEndDate': 1674487800, 'LastSubEndDateStr': '23.01.2023', 'LastSubStartDate': 1660077000, 'LastSubStartDateStr': '09.08.2022', 'LastTest': None, 'NPS Score': '10', 'NPS_score_created': 1660651966, 'NPS_score_created_test': 1666032027, 'NPS_score_new': '9 ğŸ¤©', 'NewAutoLoginToken': 'ZgTQ8l8vTXy1VuqCgn88oQ', 'NewAutoLoginUrl': 'https://school.novakidschool.com/signin?token=ZgTQ8l8vTXy1VuqCgn88oQ&user_id=712105', 'NextClassScheduled': 1671463800, 'NextClassScheduledID': '29834538', 'NextClassScheduledLevel': '2', 'NextClassScheduledStudent': 'Noam', 'NextClassScheduledTeacher': 'Emily V', 'NextClassScheduledTime': 'Monday, December 19, 2022, 17:30 (+02:00 Asia/Jerusalem)', 'NextClassScheduledTimeWoTz': 'Monday, December 19, 2022, 17:30', 'ParsedFirstName': '×× ×”', 'ParsedLastName': None, 'ParsedPhone': '+972507751161', 'ReferralCode': 'PROMO712105', 'ReferralLink': 'https://www.novakid.co.il/r/5mdr', 'Region': 'IL', 'RegisteredChildren': 'Noam (2011)', 'RegisteredChildrenCount': 1, 'RegisteredChildrenNames': 'Noam', 'SecondPaymentType': 'S24-2NN', 'SecondPurchaseDate': 1659958769, 'StudentsActiveAmount': 1, 'StudentsCompound': 'Noam (2011)', 'Survey 1': '×œ× ×™×“×•×¢ ×œ×™ ×× ×”×™×œ×“×™× ×©×œ×™ ×™×¨×¦×• ×œ×”××©×™×š ×‘×¢×ª×™×“. ×× ×™ ×œ× ×¨×•×¦×” ×œ×‘×–×‘×– ×›×¡×£.', 'TeacherCategory': None, 'TeacherCountryOfOrigin': None, 'TeacherIsL0Certified': None, 'TeacherMaxSlots': None, 'TeacherOneTimeSlotsCurrentWeek': None, 'TeacherOneTimeSlotsNextWeek': None, 'TeacherSlotsCurrentWeek': None, 'TeacherSlotsNextWeek': None, 'TeacherStartDate': None, 'TeacherTrialCategory': 'Standard', 'TeacherTrialConversionLastMonth': None, 'TeacherTrialsLastMonth': None, 'ThirdPurchaseDate': None, 'Timezone': 'Asia/Jerusalem', 'TotalPaymentsSumInUsd': 461.9, 'TrialRequestDate': None, 'TrialRequestID': None, 'UserAdminLink': 'https://admin.novakidschool.com/#/users/parents/712105/show', 'UserFullName': '×× ×”', 'UserInstagramID': None, 'UserType': 'users', 'UtmCampaign': None, 'UtmContent': None, 'UtmMedium': None, 'UtmSource': None, 'UtmTerm': None, 'WeeklyClassesFrequency': 1, 'accepts_substitutions': True, 'booking_scoring_group': 4, 'uplift_scoring_group': 3, 'utm_expid': None}, 'tags': {'type': 'list', 'data': [{'id': '5951647', 'type': 'tag', 'url': '/tags/5951647'}, {'id': '7601616', 'type': 'tag', 'url': '/tags/7601616'}, {'id': '7097593', 'type': 'tag', 'url': '/tags/7097593'}, {'id': '6650114', 'type': 'tag', 'url': '/tags/6650114'}, {'id': '6370025', 'type': 'tag', 'url': '/tags/6370025'}, {'id': '6906221', 'type': 'tag', 'url': '/tags/6906221'}, {'id': '6315942', 'type': 'tag', 'url': '/tags/6315942'}, {'id': '7386193', 'type': 'tag', 'url': '/tags/7386193'}, {'id': '6749104', 'type': 'tag', 'url': '/tags/6749104'}, {'id': '7030182', 'type': 'tag', 'url': '/tags/7030182'}], 'url': '/contacts/62caca6a619480f7c6a5d098/tags', 'total_count': 25, 'has_more': True}, 'notes': {'type': 'list', 'data': [], 'url': '/contacts/62caca6a619480f7c6a5d098/notes', 'total_count': 0, 'has_more': False}, 'companies': {'type': 'list', 'data': [], 'url': '/contacts/62caca6a619480f7c6a5d098/companies', 'total_count': 0, 'has_more': False}, 'opted_out_subscription_types': {'type': 'list', 'data': [], 'url': '/contacts/62caca6a619480f7c6a5d098/subscriptions', 'total_count': 0, 'has_more': False}, 'opted_in_subscription_types': {'type': 'list', 'data': [], 'url': '/contacts/62caca6a619480f7c6a5d098/subscriptions', 'total_count': 0, 'has_more': False}, 'utm_campaign': '[R:IL][F:LF][C:Search][P:google][Brand]', 'utm_content': None, 'utm_medium': 'cpc', 'utm_source': 'google', 'utm_term': None, 'referrer': 'https://school.novakidschool.com/parent/dashboard', 'sms_consent': False, 'unsubscribed_from_sms': False}